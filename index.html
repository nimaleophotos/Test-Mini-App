<video id="preview" autoplay playsinline></video>
<div>
  <button onclick="setZoom(0.5)">0.5x</button>
  <button onclick="setZoom(1)">1x</button>
  <button onclick="setZoom(2)">2x</button>
</div>

<script>
let stream, track;

async function initCamera() {
  stream = await navigator.mediaDevices.getUserMedia({
    video: { facingMode: "environment" }
  });
  document.getElementById("preview").srcObject = stream;
  track = stream.getVideoTracks()[0];
}

async function setZoom(level) {
  if (!track) return alert("Camera not started");
  const capabilities = track.getCapabilities();
  if ("zoom" in capabilities) {
    // Safari (iOS 16+) and some Androids map zoom to hardware lenses
    const clamped = Math.min(capabilities.zoom.max, Math.max(capabilities.zoom.min, level));
    await track.applyConstraints({ advanced: [{ zoom: clamped }] });
  } else {
    alert("Zoom not supported on this browser â€” fallback to device switching required");
  }
}

initCamera();
</script>
